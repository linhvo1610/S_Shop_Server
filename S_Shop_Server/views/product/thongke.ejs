<%- include('../inc/top') %>
<div class="container" style="min-height: 700px;" >
  <div class="row justify-content-center" style="margin-top: 10px;">
    <div class="col-md-6 text-center mb-5">
      <h2 class="heading-section"><b>Thống kê</b></h2>
    </div>
  </div>
  <div style="margin-bottom: 20px;"> 
    <form action="/bill/seachBill" method="GET" role="search">
      <div class="input-group rounded">
        <input type="search" class="form-control rounded" placeholder="Search" name="name_product" aria-describedby="search-addon" />
        <button type="submit" style="display: inline-block;
                        line-height: 30px;
                        padding: 0 50px;
                        -webkit-transition: all 0.4s ease;
                        -o-transition: all 0.4s ease;
                        -moz-transition: all 0.4s ease;
                        transition: all 0.4s ease;
                        cursor: pointer;
                        font-size: 15px;
                        border-radius: 6px;
                        margin-left: 5px;
                        text-transform: uppercase;
                        font-weight: 700;
                        color: #fff;
                        background-color: blue;
                        font-family: inherit;">
          <i class="fa fa-search"></i>
        </button>
      </div>
    </form>
  </div>

  <!-- <form action="http://192.168.11.126:3000/bill/thongketheongay"  method="Get" >
    
    <div class="container_swap">

        <div class="div_left"><label for="exampleInputPassword1" class="form-label">Ngày bắt đầu</label>
            <input type="date" class="form-control" id="startDate" name="startDate" value="data.date"></div>
   
        <div class="div_right"><label for="exampleInputPassword1" class="form-label">Ngày kết thúc</label>
            <input type="date" class="form-control" id="endDate" name="endDate" > </div>
            <button type="submit" class="btn btn-primary">Submit</button>
   
   </div>
    
   </form> -->
   <style>

    .container_swap{
    
    width: 400px;
    
    }
    
    .div_left{
    
    width: 200px;
    
    float: left;
    
    text-align: center;
    
    }
    
    .div_right{
    
    width: 200px;
    
    float: left;
    
    text-align: center;
    
    }
    
    </style>
 <table class="table">
    <thead>
      <tr>
        <th scope="col">Số sản phẩm nhập  </th>
        <th scope="col">Số sản phẩm bán</th>
        <th scope="col">Số sản phẩm còn lại</th>
        <th scope="col">Số tiền gốc</th>
        <th scope="col">Số tiền thu được</th>
        <th scope="col">Số tiền lãi</th>
       
      </tr>
    </thead>
    <tbody class="table-group-divider">
      <tr>
        
        <td> <% let tnh =0 %>
            <% let tcl1 = 0 %>
             <% if (pro.length> 0) { %> <%
                 pro.reverse().forEach((data)=>{%>
                     
                         <% let totalQuantity = 0; %>
                         <!-- Khởi tạo biến totalQuantity -->
                         <% data.sizes.forEach(function(size) { %> <% totalQuantity +=
                         size.quantity; %>
                         <!-- Tính tổng số lượng -->
                         <% }); %>
                         <% totalQuantity.toLocaleString() %>
                         <!-- Hiển thị tổng số lượng -->
                         <% tcl1 +=  totalQuantity %>
                     
                     <%} ) %>
                     
                      <% } else { %>
                         <p style="font-size: 18px">Không tìm thấy sản phẩm phù hợp.</p>
                         <% } %>
                         <%  let tdb1 = 0 %>
                         <% listBill.forEach(function(item) { %>
                         
                           
                                
                           
                               
                               <% for (var i = 0; i < item.list.length; i++) { %>
                                   <% if(item.status==5){ %>
                   
                                  <% tdb1 = tdb1 + item.list[i].quantity %>
                              
                                 <% } %>
                   
                          <% } %>
                         
                             <% }); %>
                             <% tnh = tcl1+tdb1 %>
                             <%= tnh.toLocaleString() %>
                          
           
               </td>
        <td>   <%  let tdb = 0 %>
            <% listBill.forEach(function(item) { %>
            
              
                   
              
                  
                  <% for (var i = 0; i < item.list.length; i++) { %>
                      <% if(item.status==5){ %>
      
                     <% tdb = tdb + item.list[i].quantity %>
                 
                    <% } %>
      
             <% } %>
            
                <% }); %>
                <%= tdb %>
            </td>
        <td> <% let tcl = 0 %>
            <% if (pro.length> 0) { %> <%
                pro.reverse().forEach((data)=>{%>
                    
                        <% let totalQuantity = 0; %>
                        <!-- Khởi tạo biến totalQuantity -->
                        <% data.sizes.forEach(function(size) { %> <% totalQuantity +=
                        size.quantity; %>
                        <!-- Tính tổng số lượng -->
                        <% }); %>
                        <% totalQuantity.toLocaleString() %>
                        <!-- Hiển thị tổng số lượng -->
                        <% tcl +=  totalQuantity %>
                    
                    <%} ) %>
                    <%=  tcl.toLocaleString() %>
                     <% } else { %>
                        <p style="font-size: 18px">Không tìm thấy sản phẩm phù hợp.</p>
                        <% } %>
          
            </td>
        <td>
            <%  let tienhang = 0 %>
            <% listBill.forEach(function(item) { %>
            
              
                   
              
                  
                  <% for (var i = 0; i < item.list.length; i++) { %>
                      <% if(item.status==5){ %>
      
                     <% tienhang = tienhang + item.list[i].quantity * item.list[i]. importPrice%>
                 
                    <% } %>
      
             <% } %>
            
                   
                
            
      
                <% }); %>
                <%= tienhang.toLocaleString('vi-VN', { style: 'currency', currency: 'VND' }) %>

            </td>
        <td>
            <%  let tienthu = 0 %>
            <% listBill.forEach(function(item) { %>
            
                 
              <% if(item.status==5){
                  tienthu += item.total;
             } %>
             
                   
      
                <% }); %>
                <%= tienthu.toLocaleString('vi-VN', { style: 'currency', currency: 'VND' }) %>
            </td>
        <td>
            <% let tienlai = 0 %>
            <%  let t = 0 %>
            <% listBill.forEach(function(item) { %>
            
              
                   
              
                  
                  <% for (var i = 0; i < item.list.length; i++) { %>
                      <% if(item.status==5){ %>
      
                     <% t = t + item.list[i].quantity * item.list[i]. importPrice%>
                 
                    <% } %>
      
             <% } %>
            
                   
                
            
      
                <% }); %>
               
            <%  let tdt = 0 %>
            <% listBill.forEach(function(item) { %>
            
                 
              <% if(item.status==5){
                  tdt += item.total;
             } %>
             
                   
      
                <% }); %>
               <% tienlai = tdt - t %>
               <%= tienlai.toLocaleString('vi-VN', { style: 'currency', currency: 'VND' }) %>
        </td>
        
      </tr>
      
    </tbody>
  </table>
  <br>

  <!-- thong kê theo sản phẩm -->

  <h1>Product List</h1>
    <ul>
        <% productList.forEach(product => { %>
            <li>Số lượng kho: <%= product.totalSizeQuantity %> 
            - Số lượng bán: <%= product.totalQuantity %>
            - Name: <%= product.productName %>
            - Price: <%= product.price %>
            - Giá nhập: <%= product.gianhap %>
            - Tiền bán được: <%= product.price * product.totalQuantity %>
            - Tiền nhập hàng: <%= product.totalSizeQuantity * product.gianhap %>
            - Doanh thu: <%= (product.price * product.totalQuantity) - (product.totalSizeQuantity * product.gianhap) %>
             </li>
        <% }); %>
    </ul>


  
  <style>
    .menu-link:visited {
      color: red;
    }
  </style>
 


 
</div>




<%- include('../inc/bottom') %>